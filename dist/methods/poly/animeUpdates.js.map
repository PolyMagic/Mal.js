{"version":3,"sources":["../src/methods/poly/animeUpdates.ts"],"names":[],"mappings":"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","file":"animeUpdates.js","sourcesContent":["module.exports = (name:string) => {\r\n  const rp = require('request-promise-native');\r\n  const cheerio = require('cheerio');\r\n\r\n  \r\n  return new Promise( (res, rej) => {\r\n    let $ = null;\r\n    rp(`https://myanimelist.net/profile/${name}`)\r\n    .then( body => cheerio.load(body))\r\n    .then( ch => {\r\n      $=ch;\r\n      const updatesA = $('div.statistics-updates','div.updates.anime')\r\n      if(!updatesA) { if(updatesA.length == 0) res([]) }\r\n      return updatesA;\r\n    })\r\n    .then( updatesA => {\r\n      let array = [];\r\n      updatesA.each( (i, elem) => {\r\n        let title = $(elem).find('a','div.data').text().trim();\r\n        let link = $(elem).find('a').attr('href');\r\n        let ep = $(elem).find('div.fn-grey2 span').eq(0).text().trim()\r\n        let score = $(elem).find('div.fn-grey2 span').eq(1).text().trim()\r\n        let img = $(elem).find('img').attr('src')\r\n        let graph = $(elem).find('span.graph-inner')\r\n        let date = $(elem).find('span.fn-grey2','div.clearfix').text().trim()\r\n\r\n        let watching = graph.hasClass('watching')\r\n        let dropped = graph.hasClass('dropped')\r\n        let completed = graph.hasClass('completed')\r\n        let on_hold = graph.hasClass('on_hold')\r\n        let plan_to_watch = graph.hasClass('plan_to_watch')\r\n\r\n        let color = 0;\r\n        if (watching) {\r\n          color=2994233;\r\n        }\r\n        else if(dropped){\r\n          color=10563377;\r\n        }\r\n        else if(completed){\r\n          color=2507919;\r\n        }\r\n        else if(on_hold){\r\n          color=16372823;\r\n        }\r\n        else if(plan_to_watch){\r\n          color=12829635;\r\n        }\r\n\r\n        ep = parseInt(ep);\r\n        score = parseInt(score);\r\n\r\n        let obj = {title,link, ep,score,img,date,color}\r\n        array.push(obj)\r\n      });\r\n  \r\n      res(array);\r\n    })\r\n    .catch( e => rej(e) )\r\n  })\r\n}\r\n\r\nexport interface animeUpdatesOBJ {\r\n  title: string;\r\n  link: string;\r\n  ep: number;\r\n  score: number;\r\n  img: string;\r\n  date: string;\r\n  color: number;\r\n}\r\n"],"sourceRoot":"../../../src"}